<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<!--
  ~ This file is part of Geomajas, a component framework for building
  ~ rich Internet applications (RIA) with sophisticated capabilities for the
  ~ display, analysis and management of geographic information.
  ~ It is a building block that allows developers to add maps
  ~ and other geographic data capabilities to their web applications.
  ~
  ~ Copyright 2008-2010 Geosparc, http://www.geosparc.com, Belgium
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->
<article id="release" lang="en">
  <title>Migrating between Geomajas version</title>

  <toc />

  <section>
    <title>Migrating from Geomajas 1.5.2 to Geomajas 1.5.3</title>

    <itemizedlist>
      <listitem>
        <para>The <code>LayerModel</code> class has been integrated in
        <code>VectorLayer</code>. This modifies the configuration. Where
        before you would have written <programlisting>&lt;bean name="countriesModel" class="org.geomajas.layermodel.shapeinmem.ShapeInMemLayer"&gt;
    &lt;property name="url" value="classpath:shapes/africa/country.shp"/&gt;
&lt;/bean&gt;
&lt;bean name="countries" class="org.geomajas.internal.layer.layertree.DefaultVectorLayer" &gt;
    &lt;property name="layerInfo" ref="countriesInfo" /&gt;
    &lt;property name="layerModel" ref="countriesModel" /&gt;
&lt;/bean&gt;</programlisting> into <programlisting>&lt;bean name="countries" class="org.geomajas.layer.shapeinmem.ShapeInMemLayer"&gt;
    &lt;property name="layerInfo" ref="countriesInfo" /&gt;
    &lt;property name="url" value="classpath:shapes/africa/country.shp"/&gt;
&lt;/bean&gt;</programlisting>Note that this includes changing "layermodel" to
        "layer" in all module and package names.</para>
      </listitem>

      <listitem>
        <para><code>FeaturePainter</code> interface and related stuff has been
        removed. These are obsolete with the introduction of the
        <code>VectorLayerService</code>.</para>
      </listitem>

      <listitem>
        <para><code>GeotoolsLayer</code> has been renamed
        <code>GeoToolsLayer</code>.</para>
      </listitem>

      <listitem>
        <para>With the change in directory structure, the commands have moved
        from the <code>org.geomajas.extension.command</code> package to
        <code>org.geomajas.command</code>. The <code>LogCommand</code> has
        also been moved into the <code>general</code> sub-package.</para>
      </listitem>

      <listitem>
        <para>security contraints are now applied in Geomajas. By default,
        nothing is authorized, so you always have to configure at least one
        security service. To go back to the old (allow-all) behaviour, include
        the following excerpt in your configuration file.</para>

        <programlisting>&lt;bean name="security.securityInfo" class="org.geomajas.security.SecurityInfo"&gt;
    &lt;property name="loopAllServices" value="false"/&gt;
    &lt;property name="securityServices"&gt;
        &lt;list&gt;
            &lt;bean class="org.geomajas.internal.security.AllowAllSecurityService"/&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;</programlisting>
      </listitem>

      <listitem>
        <para />
      </listitem>
    </itemizedlist>

    <section>
      <title>General API changes</title>

      <para>The geomajas-API has been split up in a formal (geomajas-API) and
      experimental API (geomajas-api-experimental). All interfaces/classes
      from the cache and rendering packages have been moved to experimental.
      This means that the rendering pipeline is at the moment not a part of
      the official API, but instead more of a preview of what's to come.
      Furthermore, some major changes have been made in many other
      packages:</para>

      <itemizedlist>
        <listitem>
          <para>The <code>org.geomajas.rendering.tile</code> has been moved to
          <code>org.geomajas.layer.tile</code></para>
        </listitem>

        <listitem>
          <para>Introduction of a DtoConverterService that is able to convert
          DTO objects from and to backend internal representations.</para>
        </listitem>

        <listitem>
          <para>All the different feature definitions have been cut down. Only
          2 versions remain at the moment: a DTO feature
          (<code>org.geomajas.layer.feature.Feature</code>) and a feature
          definition used internally in the backed
          (<code>org.geomajas.layer.feature.InternalFeature</code>).</para>
        </listitem>

        <listitem>
          <para>All the different tile definitions have been cut down. Only 3
          remain. 2 DTO tiles: <code>org.geomajas.layer.tile.VectorTile</code>
          - used in vector layers and
          <code>org.geomajas.layer.tile.RasterTile</code> - used in raster
          layers. The third is the
          <code>org.geomajas.tile.InternalTile</code>. This tile is used
          internally on the backend.</para>
        </listitem>
      </itemizedlist>
    </section>
  </section>

  <section>
    <title>Migrating from Geomajas 1.5.1 to Geomajas 1.5.2</title>

    <itemizedlist>
      <listitem>
        <para>"layerRef" is renamed to "layerIds" in
        <code>LayerTreeNodeInfo</code>.</para>
      </listitem>
    </itemizedlist>
  </section>

  <section>
    <title>Migrating from Geomajas 1.5.0 to Geomajas 1.5.1</title>

    <itemizedlist>
      <listitem>
        <para>Configuration has changed from the proprietary format to using
        spring configuration.</para>
      </listitem>

      <listitem>
        <para>There is now a <code>CommandDispatcher</code> service and
        official command names and defined request and response objects.
        Deprecated commands have been removed.</para>
      </listitem>
    </itemizedlist>
  </section>

  <section>
    <title>Migrating from Geomajas 1.4.x to 1.5.0</title>

    <para>
      <itemizedlist>
        <listitem>
          <para>In your application.xml, you should change "OSMLayerFactory"
          to "OsmLayerFactory"</para>
        </listitem>

        <listitem>
          <para>In your application.xml, you should change "WMSLayerFactory"
          to "WmsLayerFactory"</para>
        </listitem>

        <listitem>
          <para>replace package "layermodels" with "layermodel"</para>
        </listitem>

        <listitem>
          <para>replace "org.geomajas.core.application.DefaultLayerFactory"
          with "org.geomajas.internal.application.DefaultLayerFactory"</para>
        </listitem>

        <listitem>
          <para>mapWidget.addController() and mapWidget.removeController()
          have been removed. They are replaced by mapWidget.setController().
          You could only add one controller anyway.</para>
        </listitem>
      </itemizedlist>
    </para>
  </section>
</article>
