<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ This file is part of Geomajas, a component framework for building
  ~ rich Internet applications (RIA) with sophisticated capabilities for the
  ~ display, analysis and management of geographic information.
  ~ It is a building block that allows developers to add maps
  ~ and other geographic data capabilities to their web applications.
  ~
  ~ Copyright 2008-2010 Geosparc, http://www.geosparc.com, Belgium
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<chapter id="chapter-configuration">
  <title>Configuration</title>

  <para></para>

  <section>
    <title>Dependencies</title>

    <para>Make sure your include the plug-in in your project. If you are using
    maven and the geomajas-dep dependency to manage versions, include
    following dependency to your pom:</para>

    <example>
      <title>OpenStreetMap layer dependency, using geomajas-dep</title>

      <programlisting>&lt;dependency&gt;
    &lt;groupId&gt;org.geomajas.plugin&lt;/groupId&gt;
    &lt;artifactId&gt;geomajas-layer-openstreetmap&lt;/artifactId&gt;
&lt;/dependency&gt;</programlisting>
    </example>

    <para>If you are not using geomajas-dep to manage versions, then you need
    to mention the version explicitly.</para>

    <example>
      <title>OpenStreetMap layer dependency, explicit version</title>

      <programlisting>&lt;dependency&gt;
    &lt;groupId&gt;org.geomajas.plugin&lt;/groupId&gt;
    &lt;artifactId&gt;geomajas-layer-openstreetmap&lt;/artifactId&gt;
    &lt;version&gt;<?eval ${project.version}?>&lt;/version
&lt;/dependency&gt;</programlisting>
    </example>
  </section>

  <section>
    <title>OpenStreetMap raster layer</title>

    <section>
      <title>Base configuration</title>

      <para>A base OpenStreetMap layer configuration looks as follows:</para>

      <xi:include href="listing/SimpleOsmConfig.xml"
                  xmlns:xi="http://www.w3.org/2001/XInclude" />

      <warning>
        <para>If you are using 1.7.1 or earlier of the OpenStreetMap plug-in
        then this configuration will not work. In that version we simplified
        configuration by not forcing you to configure values you are not
        allowed to change anyway. For the old version, the configuration would
        look like this:</para>

        <xi:include href="listing/OsmLayerSample.xml"
                    xmlns:xi="http://www.w3.org/2001/XInclude" />

        <para>Note that these older versions did not allow any of the other
        configurations either.</para>
      </warning>
    </section>

    <section>
      <title>Image source configuration</title>

      <para>The default configuration for the OpenStreetMap layer will use the
      Mapnik rendering of OpenStreetMap by round robin iteration over the
      following base URLs:</para>

      <itemizedlist>
        <listitem>
          <para>http://a.tile.openstreetmap.org</para>
        </listitem>

        <listitem>
          <para>http://b.tile.openstreetmap.org</para>
        </listitem>

        <listitem>
          <para>http://c.tile.openstreetmap.org</para>
        </listitem>
      </itemizedlist>

      <para>This is configurable at two levels.</para>

      <para>You can configure the URLs which are used for the tiles. You
      simply define the different options using ${level}, ${x} and ${y} for
      the zoom level and tile coordinate. A simple configuration looks like
      this:</para>

      <xi:include href="listing/OsmCustomUrls.xml"
                  xmlns:xi="http://www.w3.org/2001/XInclude" />

      <para>You can also define the strategy to choose between the different
      URLs which have been configured. By default, the URLs will be chosen
      using a round robin strategy. </para>

      <para>For example, the sample below uses the cycle map tiles and selects
      the class to use for the URL selection strategy (this needs to implement
      UrlSelectionStrategy.</para>

      <xi:include href="listing/OsmCustomUrlStrategy.xml"
                  xmlns:xi="http://www.w3.org/2001/XInclude" />

      <para></para>
    </section>

    <section>
      <title>Zoom level configuration</title>

      <para>By default the maximum zoom level is 19, but this can be modified
      using the maxZoomLevel property if your data source supports a different
      level.</para>

      <xi:include href="listing/OsmMaxZoomLevelConfig.xml"
                  xmlns:xi="http://www.w3.org/2001/XInclude" />
    </section>
  </section>
</chapter>
